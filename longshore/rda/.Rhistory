theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = 0, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.1, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = 2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = -2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = -1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = -1.5) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = -1.7) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = -3) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = -1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.4, vjust = -1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.6, vjust = -1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = 0, vjust = 0) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = 0, vjust = -1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = 0, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = 1, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -1, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.5, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.3, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.2, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.3, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.3, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 2,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.3, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 5,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.3, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
m2.plot <- ggplot() +
geom_point(data = site, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp, aes(x = RDA1, y = RDA2, label = rownames(spp)),
size = 3, box.padding = 0.1, point.padding = 4,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.3, vjust = 1) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m2.plot
ggsave("long-rda-full.png", plot = m2.plot, width = 8, height = 8, dpi = 300)
### Constrained model - version 2
m3 <- rda(fin ~ year + site + temperature + salinity + chl, data=env3, scale=TRUE) # RDA analysis, scale=TRUE if not hellinger transformed
summary(m3) # % explained by variables in constrained
plot(m3)
coef(m3) # extract canonical coefficients
set.seed(111)
anova.cca(m3, STEP=1000) # checks if model is statistically significant
anova.cca(m3, by="axis", step=10000) # statistical significance of each axis
anova.cca(m3, by="term", step=10000) # statistical significance of each term
vif.cca(m3) # anything above 10/20 should be avoided
RsquareAdj(m3)$adj.r.squared
#### Plot with ggplot
spp1 <- as.data.frame(scores(m3, display = "species"))
site1 <- as.data.frame(scores(m3, display = "sites"))
loadings1 <- data.frame(Variables = c("Year", "Site", "Temperature", "Salinity", "Chl-a"),
RDA1 = c(-0.76184, -0.02123, 0.20102, 0.2235, 0.94215),
RDA2 = c(-0.19552, 0.68426, 0.43079, -0.32157, -0.01841)
)
m3.plot <- ggplot() +
geom_point(data = site1, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp1, aes(x = RDA1, y = RDA2, label = rownames(spp1)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings1, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings1, aes(x = RDA1, y = RDA2, label = Variables), hjust = 1.2, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m3.plot
m3.plot <- ggplot() +
geom_point(data = site1, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp1, aes(x = RDA1, y = RDA2, label = rownames(spp1)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings1, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings1, aes(x = RDA1, y = RDA2, label = Variables), hjust = 0, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m3.plot
m3.plot <- ggplot() +
geom_point(data = site1, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp1, aes(x = RDA1, y = RDA2, label = rownames(spp1)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings1, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings1, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.01, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m3.plot
m3.plot <- ggplot() +
geom_point(data = site1, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp1, aes(x = RDA1, y = RDA2, label = rownames(spp1)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings1, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings1, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.03, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m3.plot
m3.plot <- ggplot() +
geom_point(data = site1, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp1, aes(x = RDA1, y = RDA2, label = rownames(spp1)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings1, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings1, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.05, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m3.plot
m3.plot <- ggplot() +
geom_point(data = site1, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp1, aes(x = RDA1, y = RDA2, label = rownames(spp1)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings1, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings1, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.2, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m3.plot
m3.plot <- ggplot() +
geom_point(data = site1, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp1, aes(x = RDA1, y = RDA2, label = rownames(spp1)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings1, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings1, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.4, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m3.plot
m3.plot <- ggplot() +
geom_point(data = site1, aes(x = RDA1, y = RDA2), color = "grey50") +
geom_text_repel(data = spp1, aes(x = RDA1, y = RDA2, label = rownames(spp1)),
size = 3, box.padding = 0.1, point.padding = 0.1,
segment.color = 'grey50', color = "blue", segment.size = 0,
max.iter = 5000) +
geom_segment(data = loadings1, aes(x = 0, y = 0, xend = RDA1, yend = RDA2),
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "grey", linewidth = 0.5) +
geom_text(data = loadings1, aes(x = RDA1, y = RDA2, label = Variables), hjust = -0.3, vjust = 1.2) +
labs(x = "RDA1", y = "RDA2") +
theme_bw() +
coord_fixed()
m3.plot
ggsave("long-rda-subset.png", plot = m3.plot, width = 8, height = 8, dpi = 300)
### Plot side by side
library(patchwork)
combined <- (m2.plot | m3.plot) +
plot_annotation(tag_levels = 'a') &
theme(
plot.tag = element_text(face = 'bold', size = 16),
plot.margin = margin(t = 1, r = 1, b = 1, l = 1, unit = "pt") # adjust top, right, bottom, left margins
)
combined # view multi-panel figure
combined <- (m2.plot | m3.plot) +
plot_annotation(tag_levels = 'a') &
theme(
plot.tag = element_text(face = 'bold', size = 16) # adjust top, right, bottom, left margins
)
combined # view multi-panel figure
combined <- (m2.plot | m3.plot) +
plot_annotation(tag_levels = 'a') &
theme(
plot.tag = element_text(face = 'bold', size = 16) # adjust top, right, bottom, left margins
)
combined # view multi-panel figure
combined <- (m2.plot / m3.plot) +
plot_annotation(tag_levels = 'a') &
theme(
plot.tag = element_text(face = 'bold', size = 16) # adjust top, right, bottom, left margins
)
combined # view multi-panel figure
